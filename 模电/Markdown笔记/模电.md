# 器件

三极管、场效应管

### 半导体

本征半导体：无杂质，只有硅或者只有锗
本征激发：外层电子脱离，产生一个自由电子和一个空穴

杂质半导体：N和P；P加硼，多子空穴；N加磷，多子电子

注意：*原子、半导体的整体是电中性的*

### PN结

多子一般即载流子。等效为一个电容和电阻并联。

#### 单向导电性

扩散：多子向浓度低的一侧运动的趋势，内电场抑制扩散
复合：PN结两侧的电子和空穴运动到交界面上时互相抵消 形成一块无电子无空穴区域，即PN结，并形成内电场抑制多子的运动
漂移：少子的运动，内电场促进漂移

加正向电压使得PN结正偏：电源正接P负接N，加外电场使PN结两侧的多子克服内电场继续扩散，PN结宽度减小
导通：PN结消失
反偏：P接负，进一步抑制扩散并将多子推向两侧，PN结宽度增加；直到整个都是PN结，截止

#### 伏安特性

$I=I_s(e^{\frac{U}{U_T}}-1)$

$I_s$：反偏电流；$U_T$：温度当量，默认26mV；$U$：两侧电压，正偏取正值。

#### 击穿

雪崩击穿：PN结较厚，需要较高外电压
齐纳击穿：PN结较薄，需要较低外电压

### 二极管

二极管=PN+外壳，外壳有压降，二极管导通需要有死区电压$U_T$约等于0.3V；电流继续增加也不会增大电压的$U_1$即导通压降，约0.7V。**近似认为+0.7V导通，否则截止**
$I_R$反向饱和电流，与PN的$I_s$对应；$U_{BR}$反向击穿电压，**击穿不一定损坏！**

#### 判断二极管状态

1. 假设全部截止，即视为断路
2. 将不在闭合回路中的电阻视为导线
3. 做出每个两端电压
4. 比较0.7V，两端电压差大的优先导通（共阳极，阴极低的更导通）

### 稳压管

工作在反向截止状态，稳压状态：两端通过的电流在$I_{z_{min}}$和$I_{z_{max}}$，提供反向电压，即横线一侧为高电位
最大功率$=U_z*I_{z_{max}}$

### 三极管

箭头所在的一侧是发射极e，箭头指向就是电流流向。三个脚就是接在NPN或PNP三个区域的各一条引脚。be之间发射结，ce之间集电结。

- $I_e=I_b+I_c$，$I_e=(1+\beta)*I_b$
- 放大倍数$\beta$：$\beta=I_c/I_b，I_c=\beta*I_b$
- 输入特性曲线在$U_{CE}$恒定，横轴为$U_{BE}$，纵轴为$I_B$时，类似二极管的伏安特性曲线，$U_{BE}$达到0.7V后，电流增大，$U_{BE}$几乎不变。
- 输出特性曲线在$U_{BE}$恒定，横轴为$U_{CE}$，纵轴为$I_C$时，从原点开始立即快速上升，随后趋于水平；$U_{BE}$越大，趋于水平时的$I_C$越大，=0.7V时趋于横轴水平。
---
- **饱和区**：横轴为$U_{CE}$，快速上升的部分对应的$U_{CE}$范围；*都正偏*
- **放大区**：$U_{CE}$水平的右侧部分，即$I_C$与$U_{BE}$的变化接近线性；*发射结正，集电结反*
- **截止区**：$U_{BE}=0.7V$的下侧，$I_C$始终几乎为0；*发射结反偏即截止*

### 场效应管（FET）

绝缘栅型场效应管：MOSFET，分为增强型和耗尽型，各自又分为N沟道和P沟道
结型场效应管，分为N沟道和P沟道

s-源极 d-漏极 g-栅极

沟道之间存在另一种掺杂类型的衬底，即N沟道-P衬底或P沟道-N衬底

- $U_g$小于门限电压$U_T$时，无论$U_{ds}$多大，均没有电流通过
- 大于门限电压时，s和d之间形成对应的沟道，随着$U_{ds}$从0增大，$I_d$不为零
- $U_{ds}$增加直到$U_{gd}=U_T$，发生预夹断

#### 特性曲线（N沟道增强型绝缘栅）

$U_{gs}$与$I_d$之间关系，类似二极管，$U_T$开始上升，随着$U_{gs}$增加$I_d$快速增加，$U_{gs}$=2倍$U_T$时$I_d$增加不会连带$U_{gs}$增加
$U_{ds}$与$I_d$之间关系，类似三极管（放大饱和截止的图），放大区$I_d$随着$U_{gs}$增大，水平趋势的高度上升即$I_d$增大，$U_{gs}$=$U_T$以下的区域截止。
- $I_d=I_{DSS}(\frac{U}{U_T}-1)^2$
- $g_m$低频跨导=$I_d$对$U_{gs}$求导

$U_{gs}<U_T$截止
$U_{gs}>U_T$且$U_{gd}>U_T$：可变电阻区，相当于变阻器
$U_{gs}>U_T$且$U_{gd}<U_T$：恒流区，相当于恒流源

#### 其他的特性曲线

**形状都一样**

**输入特性：**
N增强MOS：$U_T$大于零，在纵轴右侧，且$U_{gs}$始终大于零
N耗尽MOS：$U_{gs}$有负有正，开始起作用的$U_P$对应的$U_{gs}$小于零
N结型：$U_{gs}$全小于零，整个在纵轴左侧

门限电压**大于零**称为$U_T$，**小于零**称为$U_P$

**输出特性：**
截止区临界即门限电压，往上递增，$I_d$随着$U_{gs}$增大，水平趋势的高度上升，即$I_d$增大
$U_{gs}$关于零的正负存在性与输入特性相同

# 放大电路

三极管：非线性的电流放大器件；一般在$U_{BE}$上输入电压，在$U_{CE}$上输出电压

### 单管共射极放大电路

为了让三极管不截止，在be上加一个直流偏置，b正e负->但是会使ce上输出电压失真
为了不失真，在ce上加一个电源和电阻，e负c正，电阻在正极和c之间，并且在所有这些东西和输出端正极之间加一个电容滤掉直流，对应的在所有东西和输入端正极之间加一个电容
最后加一个基极电阻在电容和基极之间保护电路

输入侧电容：消除直流干扰
输出侧电容：消除直流偏置，防止失真
电源：静态偏置，给放大供电

简化，把电源合并：
输入端正极-电容-基极；集电极-电容-输出正极；Vcc-出来两个电阻，一端电源，另一端一个接电容和集电极之间，另一个接基极和电容之间

#### 符号说明

- $i_b$：纯交流
- $i_B$：交直流混合
- $I_B$：纯直流
- $I_b$：$i_b$的有效值
- $\dot{I_b}$：$i_b$的相量

#### 静态工作点

- 使得三极管正常工作的$I_B$、$I_C$、$U_{CE}$，静态工作点对应的$U_{BE}$即放大后信号的平衡位置
- 信号在输入到三极管基极之前，已经叠加了一个能使其导通的直流了
- 求解结果的表示字母有时会加一个右下标Q形如$I_{BQ}$、$I_{CQ}$、$U_{CEQ}$

1. 将所有电容视作开路，简化电路图
2. $I_B=(V_{cc}-U_{BE})/R_b$，其中$U_{BE}$一般0.7V，有时可以忽略，即$I_B=V_{cc}/R_b$
3. $I_C=\beta I_B$
4. $U_{CE}=V_{cc}-I_c*R_c$

#### 动态分析

即微变等效电路，电容视作导线，所有直流源视作接地；此时可以发现，$R_b$相当于直接接在be两端，$R_c$相当于直接接在ce两端

然后：把be之间的箭头视作一个电阻$r_{be}$，删除bc之间连线，视作ce之间存在一个受控电流源，该源输出量即$\beta i_b$从c到e。$i_b$仍为流进基极的电流，即方向为b到e。（这是NPN，如果是PNP，那么$i_b$从e到b，受控源输出$\beta i_b$从e到c）

最后在输出的正负极之间接一个$R_L$表示负载。

- 相比原先新增了一个参数$r_{be}=200+\frac{26mV}{I_{BQ}}$
- 电压放大倍数$\dot{A_u}$ = 输出电压 / 输入电压，字面理解
- $R_o$：输出电阻，从输出端往里看，除了负载电阻以外，其余所有东西对负载的等效电阻
- $R_i$：输入电阻，从输入端往里看，所有东西的等效电阻

希望$R_i$越大越好（减小在信号源内阻上的损耗），$R_o$越小越好（减少放大电路上的损耗）

##### 求解

戴维宁等效：看进去，视作是$R_{eq}$和$U_{oc}$串联，再接出来。

1：
- 设右侧端口两端电压U，电流流入I。设法表达式$U=A+BI$，其中$A=U_{oc}, B=R_{eq}$

2：
- 内部电源设为0，电压源视作导线，电流源视作断开。
- 串并联求等效电阻
- 开路电压即去掉外面的负载电阻后开路两个端口之间的电压

结论：
- $\dot{A_u} = \frac{-\beta (R_c//R_L)}{r_{be}}$，不提负载时即为$\dot{A_u} = -\frac{\beta R_C}{r_{be}}$
- $R_i = r_{be}//R_b ≈ r_{be}$
- $R_o = R_c$

<div align=center><img src=".\模电image\单管共射极放大.png" width="35%"><div>
<div align=left><div>

### 共集电极放大电路

把共射极的$R_c$移到发射极改名$R_e$，输出接到发射极上。

#### 静态工作点

1. 将所有电容视作开路，简化电路图
2. $V_{cc} = I_bR_b+U_{BE}+I_eR_e \\ I_e=I_b+I_c = (1+\beta)I_b$
3. $I_b = \frac{V_{cc}-U_{BE}}{R_b+(1+\beta)R_e} ≈ \frac{V_{cc}}{R_b+(1+\beta)R_e}$
4. $I_c = \beta I_b = \frac{\beta V_{cc}}{R_b+(1+\beta)R_e}$
5. $U_{CE} = V_{cc}-I_eR_e = V_{cc}-(1+\beta)I_bR_e = V_{cc}(1-\frac{(1+\beta)R_e}{R_b+(1+\beta)R_e})$

#### 动态分析

1. $\dot{A_u} = \frac{(1+\beta)(R_e//R_L)}{r_{be}+(1+\beta)(R_e//R_L)}$
2. $R_i = R_b//(r_{be}+(1+\beta)(R_e//R_L))$
3. $R_o = \frac{U_o}{\frac{U_o}{R_e}-(1+\beta)\frac{U_o}{r_{be}}} ≈ \frac{r_{be}}{1+\beta} = \frac{r_{be}+(R_s//R_b)}{1+\beta}$，其中$R_s$是输入源的内阻

<div align=center><img src=".\模电image\共集电极放大.jpeg" width="35%"><div>
<div align=left><div>

### 共基极放大电路

- $\dot{A_u} = \frac{\beta(R_c//R_L)}{r_{be}}$
- $R_i = \frac{r_{be}}{1+\beta}$
- $R_o = R_c$
  
## 结论

![](.\\模电image\\三种放大电路.jpg "共射极 共集极 共基极")

- **共射极**的电压**放大倍数**含一个**负号**：反相，即时间-振幅图像关于时间轴镜像，放大倍数较大
- 共集电极的放大倍数**约等于1**：$R_e$是几千Ω，系数是一百多，$r_{be}$可以忽略，用作**电压跟随器**（输入电阻显著大，输出电阻显著小）
- **共基极**的**通频带**较宽

## 静态工作点的稳定与失真

1. 在输入曲线$i_B$-$u_{BE}$的图像上，确定一个静态工作点
2. 输入信号对应一个波形（横轴上左右变化），映射到电流（纵轴上上下变化），得到一个波形
3. 对于这个波形的平衡位置，高低极值$I_B, I_{Bmax}, I_{Bmin}$做对应的输出曲线（它们的水平趋势线的高度应该是不一样的，max最高）
4. 以静态$U_{CE}$为基准，找到三个交点，向纵轴$i_c$投影，拿到$i_c$的曲线
5. $i_c$的曲线向$U_{CE}$投影，拿到$U_{CE}$的波形（注意是不是反相）

### 失真

由于输入输出曲线不是线性的，在太大太小的区间就会失真，而温度变化会影响固有参数，导致静态工作点变化

截止失真：静态点低，在输入曲线部分，进入了下侧的平缓增加区域而不是接近直线上升部分，体现为**NPN图像上方切削，PNP负**，动态范围一般2IcRl，即不失真输出电压的峰峰值，即不失真输出电压的幅值的两倍
饱和失真：静态点高，输出曲线，进入了饱和区，不是在右侧的水平部分，体现为**NPN图像下方切削，PNP正**，动态范围一般2Uce，即不失真输出电压的峰峰值，即不失真输出电压的幅值的两倍

### 稳定静态点

1. 在基极和地之间接一个电阻$R_{b1}$（上方原有的记作$R_{b2}$），使$U_{BE}$固定在$\frac{V_{cc}R_{b1}}{R_{b1}+R_{b2}}$
2. 发射极和地之间加一个$R_e$，实现当$I_b$增大时，三极管c极上方和e极下方的分压同时增大，使$U_{CE}$稳定

#### 如何计算具有稳定静态点功能的电路的相关参数

1. 分压拿到$U_B$
2. 压降拿到$U_E$
3. $I_E = \frac{\frac{V_{cc}R_{b2}}{R_{b1}+R_{b2}}-U_{BE}}{R_e}$
4. $I_B = \frac{1}{1+\beta}I_E, I_C = \frac{\beta}{1+\beta}I_E$
5. $\dot{A_u} =  \frac{-\beta (R_c//R_L)}{r_{be}+(1+\beta)R_e}$
6. $R_i = R_{b1}//R_{b2}//(r_{be}+(1+\beta)R_e) ≈ (r_{be}+(1+\beta)R_e)$
7. $R_o = R_c$

## FET放大电路（似乎不是重点）

共射 -> 共源
共集 -> 共漏
共基 -> 共栅

### 直流分析

1. 栅极电压$U_G$：栅极的箭头和右侧两个引脚之间视作断开，对于不接在任何回路中的电阻视作导线
2. 源极电压$U_S$：于是源极和漏极相当于导线（$i_D=i_S        $），分压即可得到
3. 静态$U_{GS} = U_G-U_S$：此时应该可以化简到未知数只有$U_{GS}$和$i_D$
4. 根据fet类型，代入$U_{GS}$具体值，计算
   1. 增强型MOS：$i_D = I_{DSS}(\frac{U}{U_T}-1)^2$
   2. 耗尽型 / 结型：$i_D = I_{DSS}(\frac{U}{U_T}-1)^2$
   3. 其中角标T、P的区别在于T对应的大于零，P对应的小于零
   4. 其中的分子上的$U$就是$U_{GS}$
   5. 如何判断类型：
   
   <div align=center><img src=".\模电image\三种FET.jpg" width="45%"><div>
   <div align=left><div>
   
5. $U_{DS} = V_{DD}-I_D(R_D+R_S)$ 此时应该全部已知，代进去拿到$U_{DS}$

### 交流分析

1. G和S之间视为断路，设出gs间电流方向，d和s之间视为受控电流源
2. 受控源输出$=g_mU_{gs}$，产生新参数低频跨导$g_m=i_D$对$u_{GS}$求导，即 $g_m = -\frac{2}{U_P}\sqrt{I_{DSS}I_{DQ}}$
3. 关于负载计不计的问题：计算等效电阻，使用电压除电流时，开路电压的计算让负载断开，短路电流的计算让负载短路；计算放大倍数需要计入负载，让结论更具普遍性

### 结论

#### 共源极

共源极和共射极的放大倍数含负号，放大是反相的
- $\dot{A_u} = -g_m(R_D//R_L)$
- $R_i = R_G, R_o = R_D$
- 其中$R_G$指的是接在栅极上所有电阻的等效电阻

#### 共漏极

- $\dot{A_u} = \frac{g_m(R_e//R_L)}{1+g_m(R_e//R_L)}$
- $R_i = R_G, R_o = \frac{1}{g_m} // R_S$
- 其中$R_G$指的是接在栅极上所有电阻的等效电阻

## 多级放大电路

直接耦合：去掉输入端的电容后把后续的输入接到前项的输出上，只保留第一个输入和最后一个输出上的电容（会干扰整体的静态工作点）
阻容耦合：输出连接到输入时中间加一个电容（即中间项的输入端和输出端合并成一个）

- 总放大倍数 = 每一级的乘积
- 前级的负载R = 后级的输入电阻$R_i$，前级的输出电阻$R_o$ = 后级的源电阻$R_S$
- 总输入电阻$R_i$ = 第一级的输入电阻$R_i$，总输出电阻$R_o$ = 最后一级的输出电阻$R_o$

# 功率放大电路

## 甲类功放

$U_{CE}$的区间 右端点（最大值）$V_{cc}$，最小值即$U_{CE}$对应到即将进入饱和区的临界处，幅值$V_{cc}/2$
- 静态消耗50%的电源总功率
- 电路效率低，只有总功率的约25%

## 乙类功放

将甲类功放对应的静态工作点在输出特性曲线上向左下方移动，忽略饱和区和截止区，图像只剩平衡位置以上的上半部分，幅值$V_{cc}$
- 互补对称放置两个三极管，各产生一半波形，一个NPN一个PNP，输出在中间，箭头都在靠近输出端一侧
- 上方接$+V_{cc}$，下方接$-V_{cc}$，对应到中间位置是输出，输出通过负载接地
- 静态工作点接近原点，静态功耗约等于0
- $P_{o} = \frac{U_{om}^2}{2R_L}$，当$U_{om} = V_{cc}$时，取到最大值
- 单管功率 $P_T = \frac{P_E-P_o}{2} = \frac{1}{R_L}(\frac{V_{cc}U_{om}}{\pi}-\frac{U_{om}^2}{4})$
- 总有效功率 $P_E = P_o+2P_T = \frac{2V_{cc}U_{om}}{\pi R_L}$，当$U_{om} = V_{cc}$时，取到最大值$\frac{2V_{cc}^2}{\pi R_L}$
- 效率 = $\frac{P_o}{P_o+2P_{三极管}} = \frac{\pi}{4}\frac{U_{om}}{V_{cc}}$，当$U_{om} = V_{cc}$时，取到最大值$\frac{\pi}{4} ≈ 78.5\%$

如何选择三极管
1. 可承受的最大功率不小于0.2倍的最大输出功率，即不小于$\frac{U_{om}^2}{10R_L}$
2. 两端可承受的最大电压不小于$2V_{cc}$
3. 最大可通过电流不小于$\frac{V_{cc}}{R_L}$

实际上，乙类功放的截止区情况不可忽略，体现为交越失真：图像接近零轴时斜率显著变缓，图像类似于两个峰峰完整的正弦图像上下组合，把峰值对齐。
改进：
1. 消除失真
   1. 乙类功放的两个三极管的基极接二极管，顺序：上侧三极管基极 - 二极管正-负 - 输入端 - 二极管正-负 - 下侧三极管基极
   2. 三极管基极和电源、地之间各接一个电阻
   3. 即可获得正常的正弦波
2. 节约能源
   1. 下方$-V_{cc}$改成接地，两个三极管的发射极和输出之间接一个电容：上方导通时充电，在上方截止时放电让下方的导通*--OTL电路*
   2. 此时所有计算中出现的$V_{cc}$改为$\frac{V_{cc}}{2}$
3. 使用倍压电路替换左侧二极管
   1. 通过调节$R_3,R_4$的阻值，控制基极电流，控制$U_{CE}$
  
   <div align=center><img src=".\模电image\倍压电路.jpeg" width="45%"><div>
   <div align=left><div>
   
   2. 添加的电阻相比原有的$R_1,R_2$阻值小得多，可以忽略不计，整个倍压电路可以视作一个点
4. 两个三极管的对称性
   1. 使用复合管（达林顿管）
   
   <div align=center><img src=".\模电image\复合对称三极管.jpeg" width="25%"><div>
   <div align=left><div>
   
   2. 整个复合管视作一个三极管，整个的放大倍数即两个放大倍数的乘积
   3. 整个的$r_{be} = r_{be1}+(1+\beta_1)r_{be2}$

改进后的整体如图：

<div align=center><img src=".\模电image\功率放大电路改进.jpeg" width="50%"><div>
<div align=left><div>

改进后的功率放大电路，左侧输入为共射极接法，共射极的$R_C$即$R_1$，另外两个电阻是忽略不计的

## 差动放大器

稳定静态工作点需要发射极电阻$R_E$，但是从放大倍数的公式中可见，该电阻阻值与放大倍数负相关。稳定静态工作点需要较大的$R_E$，但是会导致放大倍数降低。

解决方法：
1. 给$R_E$并联一个电容，在直流分析静态点时电容短路正常计算，微变等效时电容短路把电阻去掉
2. 电容没法集成，需要去掉电容

### 如何解决温漂（温度造成的干扰）

芯片很小，干扰在各个引脚造成的噪音可以认为是相同的。引脚相减即可去除两个引脚上的同样的噪音，把信号分成$+\frac{1}{2}U_i$和$-\frac{1}{2}U_i$，相减即可复原并消除噪音

### 实现单端输出

两个放大电路的输出端作为整体输出的正负端，两个引脚上的差值即输出电压，实现了作差。

实现单端输出，在发射极和地之间接电阻$R_E$。该电阻在分析静态工作点时有两倍的电流流经，在动态分析时由于左右等大反向故没有电流流过，对放大倍数没有影响。

新定义：两个输入相同，称为共模信号；两个输入相反，称为差模信号（**注意：差模信号的信号是指作差后的值，即两个输入端的差值，而不是某一个输入端上的**）

### 实现单端输入

把一个输入接完整原信号，另一个接地。原信号一端可以视为两个$+\frac{1}{2}U_i$的叠加，接地端可以视作$+\frac{1}{2}U_i$和$-\frac{1}{2}U_i$的叠加

两个一起看，就是一个共模信号和一个差模信号的叠加。差动电路的基本特性就是削弱共模，增强差模，因此所有单输入信号都和双输入的没有区别了，可以任意转换。

### 如何解决下方$R_E$处由于共模信号的大电流导致的高电位

1. 把接地换成$-V_{ee}$即可随意调节
2. 把这个电阻换成电流源：理想恒流源的内阻无穷大，实现对共模干扰的衰减和对差模电流的放行

## 差动放大器的交直流分析

1. **忽略基极电流！** 从而产生二级结论：$I_C = I_E$，三极管的基极电位为零
2. 基极对应的输入端口相当于接地！
3. 静态工作点：
   - $V_{cc}-(-V_{ee}) = I_C(R_{C1}+2R_E)+U_{CE}$，$R_E$前面2的系数是因为左右两侧合流
   - $0-(-V_{ee}) = 0.7+2I_ER_E$
4. 动态分析：
   1. 差动放大器对共模输入的放大=0，直接消除
   2. 单输入先转化为双输入再分析
   3. 下侧电阻$R_E$两侧电流等大反向，直接抵消，将其视作导线直接接地拿到零电位点
   
   <div align=center><img src=".\模电image\差动放大动态分析微变等效.jpg" width="90%"><div>
   <div align=left><div>
   
   4. 放大倍数与输入方式无关，只取决于输出方式
   5. 双端输出，将负载拆成上下各一半，得到结论：
      - 差模放大倍数（注意角标是ud，左右完全对称因此$R_B,R_C$的角标无需区分，但是是单侧值不是两侧的和）$\dot{A_{ud}} = -\frac{\beta (R_C//\frac{1}{2}R_L)}{R_B+r_{be}}$
      - $R_i = 2(R_B+r_{be})$
      - $R_o = 2R_C$
   6. 单端输出，相当于负载整个在双端的图中的一半部分，一端接地，另一端接上面或者下面。
      - $\dot{A_{ud}} = -\frac{\beta (R_C//R_L)}{2(R_B+r_{be})}$ 这是输出在正差模信号一侧的情况，如果接在负差模信号一侧，右边的负号去除
      - $R_i = 2(R_B+r_{be})$
      - $R_o = R_C$ 单端输出一倍，双端输出两倍

## 电流源电路

电流源特性：动态分析时视作断路，流过电流无压降的电阻，同时可以输出固定值电流，用于缓解电源压力

### 镜像电流源

<div align=center><img src=".\模电image\镜像电流源.jpg" width="25%"><div>
<div align=left><div>

1. **忽略基极电流！** 于是$I_C=I_E$
2. 对于左侧三极管$T_1, U_C=U_B=U_{BE}=0.7V$
3. 左右对称，右侧输出$I_C=$左侧的$I_R=\frac{V_{cc}-0.7V}{R_C}$

### 比例电流源

在左右两个三极管的发射极和地之间各接一个电阻，左侧记为$R_1$，右侧记为$R_2$

1. **忽略基极电流！** 于是$I_C=I_E$
2. 输出$I_C=\frac{I_RR_1}{R_2}$，小电流控制大电流

### 微电流源

比例电流源的极限形式，让左侧接电源和电阻的一路的三极管发射极接地，等效于$R_1$趋于0，那么输出电流也趋于0

# 集成运算放大电路

将上面Part2中的各种模块的输入输出相连，电源统一，接地统一，即是集成运放。理想运放输出电阻0，输入电阻无穷大，共模抑制比无穷大，放大倍数无穷大。

## 主要参数

### 输入失调参数

差动放大电路（一般在第一级输入的位置）中的两个三极管不完全对称，导致无信号输入时，整个整体的$u_o≠0$；表现为运放的输入端都接地，输出端不为0。

- 输入失调电压：为了让接地出0，在两个输入之间加一个电压，即输入失调电压；会随温度变化，变化率定义为其温标
- 输入偏置电流：去掉输入失调电压时，由于内部结构并不对称，两引脚会有不一样大小的电流，即输入偏置电流；两引脚上电流差值的绝对值称为输入失调电流；输入失调电流会随温度变化，变化率定义为其温标

### 共模特性参数

- 共模抑制比$K_{CMR}=|\frac{\dot{A_{ud}}}{\dot{A_{uc}}}|$，即$|\frac{差模放大倍数}{共模放大倍数}|$
- 一般情况下，共模放大倍数趋于零，差模放大倍数很大，因此共模抑制比一直很大
- 但是输入的共模信号增大时，共模抑制比会减小。因此存在最大共模输入电压。

### 外特性

虚短：由于放大倍数巨大，但是输出信号幅值不超过电源电压，因此反推得到的输入两引脚之间的电压差（即输入信号）趋于0，称为虚短，即两脚之间可以视作短路，没有电压差
虚断：由于输入电阻很大，因此将输入两引脚视作断路，即左侧部分和运放之间视作断路，两引脚输入电流=0
特性曲线：纵轴输出横轴输入，在纵轴值不到正负电源电压时为一条斜率为放大倍数的斜线；达到电源电压后不再变化，为水平线。因此输入电压的范围很小。

# 反馈

输出经过一个电阻接到输入的其中之一上，并且对应的那路输出在反馈路接入点和信号输入端之间加一个电阻（接负脚时，在反馈接点和地之间接一个电阻）

- 直流反馈：输入和反馈接点之间的电阻并联一个电容，直流时电阻生效，交流时电容短路把电阻屏蔽，使反馈接入点电位为输入端值
- 交流反馈：反馈路上的电阻串联一个电容，直流时反馈路断路，交流时电容相当于导线，反馈路连通

## 瞬时极性法判断正负反馈

输入一端给信号一端接地；假设输入的为正信号，判断其他两个引脚极性。输出端信号与同相端相同，与反相端相反；同相端和反向端互相相反。

反馈使得输入减小--负反馈；反馈使得输入增大--正反馈

举例：同相端给一个正信号-->输出正信号-->反馈接到反相端，正信号给反相端，反相端的负信号受反馈到的正信号影响而减小-->负反馈

1. 运放：
   - 左侧正负号为输入，右侧三角形顶点输出
   - +侧-同相端；-侧-反向端
2. 三极管：
   - b、e输入，c输出；如果发射极通过电阻接地，那发射极和基极同相
   - b反相端，e同相端
   - 一般是输入到基极，集电极反馈到发射极上，串联负反馈；反馈路接电容，发射极有电阻，电流反馈
3. 场效应管：
   - 栅极、源极输入，漏极输出
   - 栅极反相，源极同相
4. 两进一出差动：
   - 与输出接在同一个三极管上的是反向端，另一个同相

总结：
1. 输入和反馈在同一端口：
   1. 输入信号和反馈信号相同极性（相同同相/反相属性）：正反馈
   2. 不同极性：负反馈
2. 输入和反馈在不同端口：
   1. 输入信号和反馈信号相同极性：负反馈（**注意这里不是反馈接到的那个端口的极性**）
   2. 不同极性：正反馈

## 交流负反馈

分为串联负反馈 / 并联负反馈，各又可以分为电压反馈和电流反馈，一般来说，**同端并联电流反馈，异端串联电压反馈；同并流，异串压**

串并联：输入量和反馈量之间的叠加方式，**同并异串**，即输入信号和反馈信号加在同一个端子即为并联，加在不同端子即为串联；影响输入电阻，串联无穷大，并联0

电压流：输出电压$u_o$置零（类似于接地，或将负载$R_L$短路），看是否还能有反馈信号（还有电流流过反馈路）。如果还有--电流反馈，没有反馈--电压反馈。一般来说，**串压并流** ；影响输出电阻，电流无穷大，电压0

关于电阻：注意是网络的等效阻抗，还要考虑接到的外部其他电阻；外部一般体现为并联；0电阻并联还是0，无穷大并联一般体现为外部电阻的值

### 一般方法

1. 判断出输入信号所在端子（一般即输入信号对应的正端）
2. 判断反馈正负（瞬时极性法，假设输入端给了一个正信号）
3. 判断串并联（看输入和反馈在不在一个端上）
4. 判断输入量、输出量、反馈量（串联反馈--输入和反馈都是电压；并联反馈--输入和反馈都是电流；输出量视为电流或电压都可以）
5. 判断压流（输出电压置零，看反馈量（串联看电压和虚断，并联看电流和虚短）是否为0，零--电压反馈）
6. 负载从下面绕，右边有接地-电压；左边有接地-串联
7. 负载和输入同并异串，负载电阻直接接地的是电压

### 动态分析

参数：闭环放大倍数$\dot{A_f}$，闭环电压放大倍数$\dot{A_{uf}}$，输入电阻$R_i$，输出电阻$R_o$，反馈系数$\dot{F}$

- 反馈系数$\dot{F} = \frac{\dot{X_f}}{\dot{X_o}}$，即整个网络的反馈量/输出量（注意反馈量$X$可能是电压也可能电流）
- 闭环放大倍数$\dot{A_f} = \frac{1}{\dot{F}}$，反馈系数的倒数
- 电压放大倍数$\dot{A_{uf}} = \frac{\dot{U_o}}{\dot{U_f}}$，其中并联反馈常常存在信号源$U_s$，故表达式为$\dot{A_{uf}} = \frac{\dot{U_o}}{\dot{U_s}}$

1. 电压串联负反馈
   1. 反馈系数$\dot{F_{uu}} = \frac{\dot{U_f}}{\dot{U_o}}$，反馈电压/输出电压；电压反馈决定分母是输出电压，串联反馈决定分子是反馈电压；反馈系数角标为<电流/电压种类>，先分子再分母
   2. 电压放大倍数$\dot{A_{uf}} = \frac{\dot{U_o}}{\dot{U_f}} = \frac{1}{\dot{F_{uu}}}$
   3. $R_i = \infty, R_o = 0$
2. 电流串联负反馈
   1. 反馈系数$\dot{F_{ui}} = \frac{\dot{U_f}}{\dot{I_o}}$，反馈电压/输出电流；电流反馈决定分母是输出电流，串联反馈决定分子是反馈电压；反馈系数角标为<电流/电压种类>，先分子再分母
   2. $R_i = \infty, R_o = \infty$
3. 电压并联负反馈
   1. 反馈系数$\dot{F_{iu}} = \frac{\dot{I_f}}{\dot{U_o}}$，反馈电流/输出电压；电压反馈决定分母是输出电压，并联反馈决定分子是反馈电流；反馈系数角标为<电流/电压种类>，先分子再分母
   2. $R_i = 0, R_o = 0$
4. 电流并联负反馈
   1. 反馈系数$\dot{F_{ii}} = \frac{\dot{I_f}}{\dot{I_o}}$，反馈电流/输出电流；电流反馈决定分母是输出电流，并联反馈决定分子是反馈电流；反馈系数角标为<电流/电压种类>，先分子再分母
   2. $R_i = 0, R_o = \infty$

# 信号处理

同相端信号正系数，反相端负系数，电阻和反馈路电阻的比例产生系数绝对值

一般只用反相，所有正系数的全加在第一个反相，然后接到第二个反相和所有负系数的全加

## 反相比例运算器（电压并联负反馈）

运算放大器两个端口接出电阻 ，+接地，-输入，反馈加到-和-上的电阻之间，+上的电阻阻值$=R_-//R_f$即-上电阻与反馈上电阻并联值

- 反相：输入信号加在运算放大器的反相端
- 比例：输出和输入存在比例关系
- 可以看出：$u_o = -\frac{R_f}{R_-}u_i$；其中$R_f$是反馈路上的电阻，接到输入同一端；$R$是反馈接入点与信号端之间的电阻；系数$-\frac{R_f}{R_-}$即整个电路的闭环电压放大倍数$\dot{A_{uf}}$
- $R_{if} = R_-, R_{of} = 0$

再接一个信号和电阻在原有的$R_-$右侧，-端口左侧；$u_o = -(\frac{R_f}{R_{-1}}u_{i1}+\frac{R_f}{R_{-2}}u_{i2})$

## 同相比例运算器（电压串连负反馈）

信号加在+端，-端接地，反馈加到-和-上的电阻之间

- $u_o = (1+\frac{R_f}{R_+})u_i$
- $R_{if} = \infty, R_{of} = 0$

再接一个信号和电阻在原有的$R_+$右侧，+端口左侧；$u_o = (1+\frac{R_f}{R_{+1}})u_{i1}+(1+\frac{R_f}{R_{+2}})u_{i2}$

## 积分器

反相运算器的反馈路电阻换电容

$u_o = -\frac{1}{RC}\int_{t_0}^{t}u_{i}dt$

## 微分器

积分器反馈路电容换电阻，反相端电阻换电容

$u_o = -RC\frac{du_i}{dt}$

## 对数器

反相运算器的反馈路电阻换成（输入指向输出）的二极管，低电位在输出一侧

$u_o = -u_T\ln \frac{u_i}{RI_S}$，其中$I_S$是反偏电流，$U_T$是温度当量，$R$是输入信号路的电阻

## 指数器

对数器反馈路二极管换电阻，反相端电阻换二极管，输入端指向放大器，输入端一侧高电位

$u_o = -RI_Se^{\frac{u_i}{U_T}}$

## 乘除幂根

1. 乘：
   1. 两个对数相加可表现为括号内部分相乘，并合并为一项；两个对数器的输出接到反相比例运算器的输入，反相比例输出接到指数器的输入，指数输出即是乘法器。
   2. 注意两个对数器的放大倍数，即$u_o = -k\ln u_i$的$k$必须是相等值。
2. 幂：
   1. 多个乘法器叠加
3. 除：
   1. 以乘法器的输出和其中一个输入为新的二端口输入，另一原先的输入端口即除法输出
   2. 反相比例运算器的反馈路，输入侧通过电阻接乘法器输出，输出侧接乘法器其中一个输入；反相输入--除法分子，乘法器另一个输入--除法分母，反相输出--商
   3. $u_o = -\frac{R_2}{kR_1}\frac{u_{i1}}{u_{i2}}$，其中$R_1$是反相器输入和乘法器接入之间的电阻，$R_2$是乘法器支路上的电阻，$k$是乘法器的倍率
4. 开方：
   1. 将除法器在乘法器上的那个输入也接到反相器的输出上，将乘法器两个输入短路
   2. $u_o = \sqrt{-\frac{R_2}{kR_1}u_{i1}}$

## 信号发生器

反相器去掉输入端，改成一个反馈网络接到输出上

### RC桥式网络

大致输出正弦波，效果主要是筛选频率

<div align=center><img src=".\模电image\RC桥式.jpeg" width="35%"><div>
<div align=left><div>

该网络只允许$f = \frac{1}{2\pi RC}$的信号通过

- 幅值平衡条件：反馈系数$\dot{F} = \frac{1}{3}$，调节信号放大器放大倍数$=3$，即可使得信号稳定输出。即需要$|\dot{A}\cdot \dot{F}| = 1$。放大倍数$=1+\frac{R_f}{R}$，其中$R$是输入端到反馈接入点之间的电阻，$R_f$是反馈路上的电阻，即需要使得$R_f = 2R$

- 起振条件：$|\dot{A}\cdot \dot{F}|$略大于$1$，将微小信号先放大；体现为信号振幅由小变大，后期逐渐趋于稳定振幅值

- 相位平衡条件：由于反馈网络中存在电容，导致出现相位偏移，需要使$\phi_A + \phi_F = 2n\pi$，即放大倍数的幅角和反馈的幅角相加抵消相位偏移。

<div align=center><img src=".\模电image\RC桥式网络.jpeg" width="35%"><div>
<div align=left><div>

### RC移相网络

- 选频：$f = \frac{1}{2\pi \sqrt{6}RC}$，即产生的波形
- 反馈系数：$|\dot{F}| = \frac{1}{29}$，同样地，起振条件需要$|\dot{A}|$略大于$29$，幅值平衡条件需要$|\dot{A}| = 29$
- 反馈系数幅角：$\phi_F = \pm \pi$，因此放大器必须反相，即相比于RC桥式网络，移相网络的放大器的 + 端口通过电阻接地，RC移相网络的两个端口接在原有的 - 端对应的$u_i$和放大器的$u_o$上（类似于在所有东西外侧）

<div align=center><img src=".\模电image\RC移相.jpg" width="60%"><div>
<div align=left><div>

### LC网络

LR串联后与C并联，端口接到整个东西的并联结点，即外部东西与这个整体并联。谐振频率：$f = \frac{1}{2\pi \sqrt{LC}}$

使用时一般一端接电源，一端接放大器输出。如何实现反馈？
- 将LC中的电感作为空芯变压器的原边，副边感应出的信号接到放大器 + 端。无论变压器如何连接，选频公式中的电感取值应当是和电容并联的电感的值
- 在电感或电容中间引出一个抽头，接到信号接到放大器 + 端。

#### 中间抽头电路

<div align=center><img src=".\模电image\LC反馈.jpg" width="60%"><div>
<div align=left><div>

其中电容中间抽头会导致选频变化为$f = \frac{1}{2\pi \sqrt{L\frac{C_1C_2}{C_1+C_2}}}$

## 波形转换

### 正弦->方波

1. 不加反馈的放大器，- 端接地，+ 端接正弦信号，输出方波。放大器会把超出电源电压部分切平，未超出时斜率大幅增加接近垂直。
   - 将放大区的电压范围视为趋于0 -> 同相过零比较器，特性曲线$=sgn\ x$
   - 反相过零比较器，+ 端接地，- 端接正弦信号，特性曲线$=-sgn\ x$
   - 将接地端接到$u_{ref}$，图像整体右移$u_{ref}$，即突变点横坐标（输入信号的电压值）增加$u_{ref}$，此时效果类似电压比较器：+ 端电位高于 -，输出大于零；否则小于零
   - 如果在输出端后侧通过$U_z$的稳压管接地，那么输出端只会输出$\pm U_z$
   - **缺点：** 由于正弦信号不一定是完全光滑的，因此产生的方波在突变点附近会上下振动多次
2. 为了解决不加反馈的放大器的缺陷，使用**迟滞比较器**（施密特触发器）
   - 在 + 端（即没有输入信号的一端）接出电阻$R_f$到输出上
   - 变化：有两个门限电压$U_{T+}$和$U_{T-}$，只有当输入信号增大直到大于$U_{T+}$时，或减小直到小于$U_{T-}$时，输出才反转高低电位
   - 将$U_{ref}$上的电阻记作$R$，两个门限为$\frac{R_f}{R+R_f}U_{ref}\pm \frac{R}{R+R_f}U_z$
3. 方波发生器
   - 把RC接到迟滞比较器上，去掉$U_{ref}$，就是方波发生器
   
   <div align=center><img src=".\模电image\方波发生器.jpg" width="30%"><div>
   <div align=left><div>

   - 电容的周期性充放电的峰值即门限电压$U_{T+}$和$U_{T-}$，由于去掉了$U_{ref}$，两个门限为$\pm \frac{R_0}{R_0+R_f}U_z$
   - 产生的方波的周期$T = 2RC\ln (1+\frac{2R_0}{R_f})$
4. 三角波发生器
   - 把方波输入到反相积分器即可输出三角波
   - 体现为：迟滞比较器的输出接反相积分器输入，反相积分器的输出接到迟滞比较器的输入作为更大的反馈

   <div align=center><img src=".\模电image\三角波发生器.jpg" width="50%"><div>
   <div align=left><div>

   - 三角波的峰值：$\pm \frac{R_1}{R_2}U_z$；中间的方波为$\pm U_z$
   - 周期：$4RC\frac{R_1}{R_2}$

# 直流稳压电源

## 整流

### 半波整流

用一个二极管去掉一半的波形

- 整流后电压有效值 = 0.45倍整流前有效值
- 输出电流 = 0.45输入电压 / 负载电阻
- 二级管承受的反向最大电压 = $\sqrt{2}$输入电压有效值 = 电压峰值

### 全波整流

在降压变压器副边的上下各接一个由变压器朝向负载的二极管，接到负载的同一个端口上，负载另一个端口可以从变压器副边中间抽头，相当于把下半部分镜像到上面

- 整流后电压有效值 = 0.9倍整流前有效值
- 输出电流 = 0.9输入电压 / 负载电阻
- 二级管承受的反向最大电压 = $2\sqrt{2}$输入电压有效值 = 2倍电压峰值

### 桥式整流

<div align=center><img src=".\模电image\桥式整流.jpeg" width="50%"><div>
<div align=left><div>

- 整流后电压有效值 = 0.9倍整流前有效值
- 输出电流 = 0.9输入电压 / 负载电阻
- 二级管承受的反向最大电压 = $\sqrt{2}$输入电压有效值 = 电压峰值

## 滤波

### 电容滤波

在负载两端并联一个电容，滤波后有效值 = $\frac{4}{3}$倍原先有效值，即经过桥式整流+电容滤波后电压有效值 = 1.2倍整流前有效值

### 电感滤波

负载串联一个电感，滤波后有效值不变，即经过桥式整流+电容滤波后电压有效值 = 0.9倍整流前有效值

## 稳压

### 稳压管稳压（并联稳压）

和负载并联一个稳压管

### 串联稳压

<div align=center><img src=".\模电image\串联稳压.jpeg" width="50%"><div>
<div align=left><div>

- 输出电压$U_o = \frac{R_1+R_2}{R_2}U_{ref} = U_i-U_{CE}$，其中$U_{CE}$为调整管的$U_{CE}$