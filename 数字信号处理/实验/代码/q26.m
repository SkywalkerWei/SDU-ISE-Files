wp=0.2*pi;
ws=0.3*pi;
wc=0.6*pi;
rp=1;
as=15;
Fs=1000;
T=1/Fs;
op=(2/T)*tan(wp/2);
os=(2/T)*tan(ws/2);
omc=(2/T)*tan(wc/2);
figure;
[n,oc]=cheb1ord(op,os,rp,as,'s');
[z,p,k]=cheb1ap(n,rp);
b=k*real(poly(z));
a=real(poly(p));
[b,a]=lp2lp(b,a,oc);
[b,a]=bilinear(b,a,Fs);
[H,w]=freqz(b,a);
subplot(221),plot(w/pi,abs(H));
title('切比1低通幅频特性');xlabel('单位：Xpi');set(gca,'Xtick',[0.2,0.3]);grid;
subplot(222),plot(w/pi,angle(H));title('切比1低通相频特性');xlabel('单位：Xpi');
set(gca,'Xtick',[0.2,0.3]);grid;
subplot(223),plot(w/pi,20*log10(abs(H)/max(abs(H))));title('切比1低通分贝幅频特性');
xlabel('单位：Xpi');
set(gca,'Xtick',[0.2,0.3]);grid;
subplot(224),grpdelay(b,a);
az=-cos((wp+wc)/2)/cos((wp-wc)/2);
Nz=[-az,-1];
Dz=[1,az];
[b,a]=zmapping(b,a,Nz,Dz);
[H,w]=freqz(b,a);
figure;
subplot(221),plot(w/pi,abs(H));
title('切比1数字频带变换');xlabel('单位：Xpi');ylabel('高通幅频特性');set(gca,'Xtick',[0.6]);grid;
subplot(222),plot(w/pi,angle(H));title('切比1数字频带变换');ylabel('高通相频特性');xlabel('单位：Xpi');
set(gca,'Xtick',[0.6]);grid;
subplot(223),plot(w/pi,20*log10(abs(H)/max(abs(H))));title('切比1数字频带变换');
ylabel('高通分贝幅频特性');
xlabel('单位：Xpi');
set(gca,'Xtick',[0.6]);grid;
subplot(224),grpdelay(b,a);
figure;
[n,oc]=cheb1ord(op,os,rp,as,'s');
[z,p,k]=cheb1ap(n,rp);
b=k*real(poly(z));
a=real(poly(p));
[b,a]=lp2hp(b,a,omc);
[b,a]=bilinear(b,a,Fs);
[H,w]=freqz(b,a);
subplot(221),plot(w/pi,abs(H));
title('切比1模拟频带变换');xlabel('单位：Xpi');ylabel('高通幅频特性');set(gca,'Xtick',[0.6]);grid;
subplot(222),plot(w/pi,angle(H));title('切比1模拟频带变换');ylabel('高通相频特性');xlabel('单位：Xpi');
set(gca,'Xtick',[0.6]);grid;
subplot(223),plot(w/pi,20*log10(abs(H)/max(abs(H))));title('切比1模拟频带变换');
ylabel('高通分贝幅频特性');
xlabel('单位：Xpi');
set(gca,'Xtick',[0.6]);grid;
subplot(224),grpdelay(b,a);