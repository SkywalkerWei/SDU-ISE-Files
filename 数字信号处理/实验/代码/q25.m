wp=0.2*pi;
ws=0.3*pi;
rp=1;
as=15;
Fs=1000;
T=1/Fs;
op=(2/T)*tan(wp/2);
os=(2/T)*tan(ws/2);
figure;
[n,oc]=buttord(op,os,rp,as,'s');
[z,p,k]=buttap(n);
b=k*real(poly(z));
a=real(poly(p));
[b,a]=lp2lp(b,a,oc);
[b,a]=bilinear(b,a,Fs);
[H,w]=freqz(b,a);
subplot(221),plot(w/pi,abs(H));
title('巴特幅频特性');xlabel('单位：Xpi');
set(gca,'Xtick',[0.2,0.3]);grid;
subplot(222),plot(w/pi,angle(H));title('巴特相频特性');xlabel('单位：Xpi');
set(gca,'Xtick',[0.2,0.3]);grid;
subplot(223),plot(w/pi,20*log10(abs(H)/max(abs(H))));title('巴特分贝幅频特性');
xlabel('单位：Xpi');
set(gca,'Xtick',[0.2,0.3]);grid;
subplot(224),grpdelay(b,a);
figure;
[n,oc]=cheb1ord(op,os,rp,as,'s');
[z,p,k]=cheb1ap(n,rp);
b=k*real(poly(z));
a=real(poly(p));
[b,a]=lp2lp(b,a,oc);
[b,a]=bilinear(b,a,Fs);
[H,w]=freqz(b,a);
subplot(221),plot(w/pi,abs(H));
title('切比1幅频特性');xlabel('单位：Xpi');set(gca,'Xtick',[0.2,0.3]);grid;
subplot(222),plot(w/pi,angle(H));title('切比1相频特性');xlabel('单位：Xpi');
set(gca,'Xtick',[0.2,0.3]);grid;
subplot(223),plot(w/pi,20*log10(abs(H)/max(abs(H))));title('切比1分贝幅频特性');
xlabel('单位：Xpi');
set(gca,'Xtick',[0.2,0.3]);grid;
subplot(224),grpdelay(b,a);
figure;
[n,oc]=cheb2ord(op,os,rp,as,'s');
[z,p,k]=cheb2ap(n,as);
b=k*real(poly(z));
a=real(poly(p))
[b,a]=lp2lp(b,a,oc);
[b,a]=bilinear(b,a,Fs);
[H,w]=freqz(b,a);
subplot(221),plot(w/pi,abs(H));
title('切比2幅频特性');xlabel('单位：Xpi');set(gca,'Xtick',[0.2,0.3]);grid;
subplot(222),plot(w/pi,angle(H));title('切比2相频特性');xlabel('单位：Xpi');
set(gca,'Xtick',[0.2,0.3]);grid;
subplot(223),plot(w/pi,20*log10(abs(H)/max(abs(H))));title('切比2分贝幅频特性');
xlabel('单位：Xpi');set(gca,'Xtick',[0.2,0.3]);grid;
subplot(224),grpdelay(b,a);
figure;
[n,oc]=ellipord(op,os,rp,as,'s');
[z,p,k]=ellipap(n,rp,as);
b=k*real(poly(z));
a=real(poly(p));
[b,a]=lp2lp(b,a,oc);
[b,a]=bilinear(b,a,Fs);
[H,w]=freqz(b,a);
subplot(221),plot(w/pi,abs(H));
title('椭圆幅频特性');xlabel('单位：Xpi');set(gca,'Xtick',[0.2,0.3]);grid;
subplot(222),plot(w/pi,angle(H));title('椭圆相频特性');xlabel('单位：Xpi');
set(gca,'Xtick',[0.2,0.3]);grid;
subplot(223),plot(w/pi,20*log10(abs(H)/max(abs(H))));title('椭圆分贝幅频特性');
xlabel('单位：Xpi');set(gca,'Xtick',[0.2,0.3]);grid;
subplot(224),grpdelay(b,a);