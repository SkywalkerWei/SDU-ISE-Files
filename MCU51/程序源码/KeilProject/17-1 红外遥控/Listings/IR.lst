C51 COMPILER V9.54   IR                                                                    04/15/2021 22:43:03 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE IR
OBJECT MODULE PLACED IN .\Objects\IR.obj
COMPILER INVOKED BY: D:\Keil5\C51\BIN\C51.EXE IR.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\IR.lst) 
                    -OBJECT(.\Objects\IR.obj)

line level    source

   1          #include <REGX52.H>
   2          #include "Timer0.h"
   3          #include "Int0.h"
   4          
   5          unsigned int IR_Time;
   6          unsigned char IR_State;
   7          
   8          unsigned char IR_Data[4];
   9          unsigned char IR_pData;
  10          
  11          unsigned char IR_DataFlag;
  12          unsigned char IR_RepeatFlag;
  13          unsigned char IR_Address;
  14          unsigned char IR_Command;
  15          
  16          /**
  17            * @brief  Á∫¢Â§ñÈÅ•ÊéßÂàùÂßãÂåñ
  18            * @param  Êó†
  19            * @retval Êó†
  20            */
  21          void IR_Init(void)
  22          {
  23   1              Timer0_Init();
  24   1              Int0_Init();
  25   1      }
  26          
  27          /**
  28            * @brief  Á∫¢Â§ñÈÅ•ÊéßËé∑ÂèñÊî∂Âà∞Êï∞ÊçÆÂ∏ßÊ†áÂøó‰Ωç
  29            * @param  Êó†
  30            * @retval ÊòØÂê¶Êî∂Âà∞Êï∞ÊçÆÂ∏ßÔºå1‰∏∫Êî∂Âà∞Ôºå0‰∏∫Êú™Êî∂Âà∞
  31            */
  32          unsigned char IR_GetDataFlag(void)
  33          {
  34   1              if(IR_DataFlag)
  35   1              {
  36   2                      IR_DataFlag=0;
  37   2                      return 1;
  38   2              }
  39   1              return 0;
  40   1      }
  41          
  42          /**
  43            * @brief  Á∫¢Â§ñÈÅ•ÊéßËé∑ÂèñÊî∂Âà∞ËøûÂèëÂ∏ßÊ†áÂøó‰Ωç
  44            * @param  Êó†
  45            * @retval ÊòØÂê¶Êî∂Âà∞ËøûÂèëÂ∏ßÔºå1‰∏∫Êî∂Âà∞Ôºå0‰∏∫Êú™Êî∂Âà∞
  46            */
  47          unsigned char IR_GetRepeatFlag(void)
  48          {
  49   1              if(IR_RepeatFlag)
  50   1              {
  51   2                      IR_RepeatFlag=0;
  52   2                      return 1;
  53   2              }
  54   1              return 0;
C51 COMPILER V9.54   IR                                                                    04/15/2021 22:43:03 PAGE 2   

  55   1      }
  56          
  57          /**
  58            * @brief  Á∫¢Â§ñÈÅ•ÊéßËé∑ÂèñÊî∂Âà∞ÁöÑÂú∞ÂùÄÊï∞ÊçÆ
  59            * @param  Êó†
  60            * @retval Êî∂Âà∞ÁöÑÂú∞ÂùÄÊï∞ÊçÆ
  61            */
  62          unsigned char IR_GetAddress(void)
  63          {
  64   1              return IR_Address;
  65   1      }
  66          
  67          /**
  68            * @brief  Á∫¢Â§ñÈÅ•ÊéßËé∑ÂèñÊî∂Âà∞ÁöÑÂëΩ‰ª§Êï∞ÊçÆ
  69            * @param  Êó†
  70            * @retval Êî∂Âà∞ÁöÑÂëΩ‰ª§Êï∞ÊçÆ
  71            */
  72          unsigned char IR_GetCommand(void)
  73          {
  74   1              return IR_Command;
  75   1      }
  76          
  77          //Â§ñÈÉ®‰∏≠Êñ≠0‰∏≠Êñ≠ÂáΩÊï∞Ôºå‰∏ãÈôçÊ≤øËß¶ÂèëÊâßË°å
  78          void Int0_Routine(void) interrupt 0
  79          {
  80   1              if(IR_State==0)                         //Áä∂ÊÄÅ0ÔºåÁ©∫Èó≤Áä∂ÊÄÅ
  81   1              {
  82   2                      Timer0_SetCounter(0);   //ÂÆöÊó∂ËÆ°Êï∞Âô®Ê∏Ö0
  83   2                      Timer0_Run(1);                  //ÂÆöÊó∂Âô®ÂêØÂä®
  84   2                      IR_State=1;                             //ÁΩÆÁä∂ÊÄÅ‰∏∫1
  85   2              }
  86   1              else if(IR_State==1)            //Áä∂ÊÄÅ1ÔºåÁ≠âÂæÖStart‰ø°Âè∑ÊàñRepeat‰ø°Âè∑
  87   1              {
  88   2                      IR_Time=Timer0_GetCounter();    //Ëé∑Âèñ‰∏ä‰∏ÄÊ¨°‰∏≠Êñ≠Âà∞Ê≠§Ê¨°‰∏≠Êñ≠ÁöÑÊó∂Èó¥
  89   2                      Timer0_SetCounter(0);   //ÂÆöÊó∂ËÆ°Êï∞Âô®Ê∏Ö0
  90   2                      //Â¶ÇÊûúËÆ°Êó∂‰∏∫13.5msÔºåÂàôÊé•Êî∂Âà∞‰∫ÜStart‰ø°Âè∑ÔºàÂà§ÂÆöÂÄºÂú®12MHzÊô∂ÊåØ‰∏ã‰∏∫13500ÔºåÂú®11.0592MH
             -zÊô∂ÊåØ‰∏ã‰∏∫12442Ôºâ
  91   2                      if(IR_Time>13500-500 && IR_Time<13500+500)
  92   2                      {
  93   3                              IR_State=2;                     //ÁΩÆÁä∂ÊÄÅ‰∏∫2
  94   3                      }
  95   2                      //Â¶ÇÊûúËÆ°Êó∂‰∏∫11.25msÔºåÂàôÊé•Êî∂Âà∞‰∫ÜRepeat‰ø°Âè∑ÔºàÂà§ÂÆöÂÄºÂú®12MHzÊô∂ÊåØ‰∏ã‰∏∫11250ÔºåÂú®11.0592
             -MHzÊô∂ÊåØ‰∏ã‰∏∫10368Ôºâ
  96   2                      else if(IR_Time>11250-500 && IR_Time<11250+500)
  97   2                      {
  98   3                              IR_RepeatFlag=1;        //ÁΩÆÊî∂Âà∞ËøûÂèëÂ∏ßÊ†áÂøó‰Ωç‰∏∫1
  99   3                              Timer0_Run(0);          //ÂÆöÊó∂Âô®ÂÅúÊ≠¢
 100   3                              IR_State=0;                     //ÁΩÆÁä∂ÊÄÅ‰∏∫0
 101   3                      }
 102   2                      else                                    //Êé•Êî∂Âá∫Èîô
 103   2                      {
 104   3                              IR_State=1;                     //ÁΩÆÁä∂ÊÄÅ‰∏∫1
 105   3                      }
 106   2              }
 107   1              else if(IR_State==2)            //Áä∂ÊÄÅ2ÔºåÊé•Êî∂Êï∞ÊçÆ
 108   1              {
 109   2                      IR_Time=Timer0_GetCounter();    //Ëé∑Âèñ‰∏ä‰∏ÄÊ¨°‰∏≠Êñ≠Âà∞Ê≠§Ê¨°‰∏≠Êñ≠ÁöÑÊó∂Èó¥
 110   2                      Timer0_SetCounter(0);   //ÂÆöÊó∂ËÆ°Êï∞Âô®Ê∏Ö0
 111   2                      //Â¶ÇÊûúËÆ°Êó∂‰∏∫1120usÔºåÂàôÊé•Êî∂Âà∞‰∫ÜÊï∞ÊçÆ0ÔºàÂà§ÂÆöÂÄºÂú®12MHzÊô∂ÊåØ‰∏ã‰∏∫1120ÔºåÂú®11.0592MHzÊô∂Ê
             -åØ‰∏ã‰∏∫1032Ôºâ
 112   2                      if(IR_Time>1120-500 && IR_Time<1120+500)
 113   2                      {
C51 COMPILER V9.54   IR                                                                    04/15/2021 22:43:03 PAGE 3   

 114   3                              IR_Data[IR_pData/8]&=~(0x01<<(IR_pData%8));     //Êï∞ÊçÆÂØπÂ∫î‰ΩçÊ∏Ö0
 115   3                              IR_pData++;                     //Êï∞ÊçÆ‰ΩçÁΩÆÊåáÈíàËá™Â¢û
 116   3                      }
 117   2                      //Â¶ÇÊûúËÆ°Êó∂‰∏∫2250usÔºåÂàôÊé•Êî∂Âà∞‰∫ÜÊï∞ÊçÆ1ÔºàÂà§ÂÆöÂÄºÂú®12MHzÊô∂ÊåØ‰∏ã‰∏∫2250ÔºåÂú®11.0592MHzÊô∂Ê
             -åØ‰∏ã‰∏∫2074Ôºâ
 118   2                      else if(IR_Time>2250-500 && IR_Time<2250+500)
 119   2                      {
 120   3                              IR_Data[IR_pData/8]|=(0x01<<(IR_pData%8));      //Êï∞ÊçÆÂØπÂ∫î‰ΩçÁΩÆ1
 121   3                              IR_pData++;                     //Êï∞ÊçÆ‰ΩçÁΩÆÊåáÈíàËá™Â¢û
 122   3                      }
 123   2                      else                                    //Êé•Êî∂Âá∫Èîô
 124   2                      {
 125   3                              IR_pData=0;                     //Êï∞ÊçÆ‰ΩçÁΩÆÊåáÈíàÊ∏Ö0
 126   3                              IR_State=1;                     //ÁΩÆÁä∂ÊÄÅ‰∏∫1
 127   3                      }
 128   2                      if(IR_pData>=32)                //Â¶ÇÊûúÊé•Êî∂Âà∞‰∫Ü32‰ΩçÊï∞ÊçÆ
 129   2                      {
 130   3                              IR_pData=0;                     //Êï∞ÊçÆ‰ΩçÁΩÆÊåáÈíàÊ∏Ö0
 131   3                              if((IR_Data[0]==~IR_Data[1]) && (IR_Data[2]==~IR_Data[3]))      //Êï∞ÊçÆÈ™åËØÅ
 132   3                              {
 133   4                                      IR_Address=IR_Data[0];  //ËΩ¨Â≠òÊï∞ÊçÆ
 134   4                                      IR_Command=IR_Data[2];
 135   4                                      IR_DataFlag=1;  //ÁΩÆÊî∂Âà∞ËøûÂèëÂ∏ßÊ†áÂøó‰Ωç‰∏∫1
 136   4                              }
 137   3                              Timer0_Run(0);          //ÂÆöÊó∂Âô®ÂÅúÊ≠¢
 138   3                              IR_State=0;                     //ÁΩÆÁä∂ÊÄÅ‰∏∫0
 139   3                      }
 140   2              }
 141   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    370    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     12    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
